function C(){const h=new WebSocket(`ws://${location.host}`);h.onopen=()=>setInterval(()=>h.send("ping"),5000),h.onmessage=(M)=>{if(M.data!=="Well received")console.log(M.data);if(M.data==="reload")location.reload()}}function o(...h){const M=[];for(let J of h){const W=document.getElementById(J);if(W===null)return console.error(`Cannot get any HTML Element given the "${J}" id`),null;M.push(W)}return M}function B(h){const M=o(h.canvasId,h.solutionSpaceSizePId,h.resetBtnId,h.gtBtnId,h.btBtnId,h.ncCheckboxId,h.acNoneRadioId,h.ac1RadioId,h.ac3RadioId,h.testedSolutionsPId,h.prunedSolutionsPId,h.progressPId,h.timeleftPId);if(M===null)return null;return{canvas:M[0],solutionSpaceSizeP:M[1],resetBtn:M[2],gtBtn:M[3],btBtn:M[4],ncCheckbox:M[5],acNoneRadio:M[6],ac1Radio:M[7],ac3Radio:M[8],testedSolutionsP:M[9],prunedSolutionsP:M[10],progressP:M[11],timeleftP:M[12]}}function S(h){h.elements.canvas.onmousemove=(M)=>{M.stopPropagation();const{offsetX:J,offsetY:W}=M,$=Math.min(Math.floor(J/h.ui.cellSize),8),q=Math.min(Math.floor(W/h.ui.cellSize),8),Q=h.getSelectedCell();document.onclick=()=>{if(Q===null||Q[0]!==$||Q[1]!==q)h.setSelectedCell([$,q]),h.refreshGrid()}},h.elements.canvas.onmouseout=(M)=>{if(M.stopPropagation(),h.getSelectedCell()!==null)h.setSelectedCell(null),h.refreshGrid()},document.onkeyup=(M)=>{if(M.stopPropagation(),M.key>="1"&&M.key<="9"&&h.getSelectedCell()!==null){const J=parseInt(M.key);if(J%1===0)h.toggle(J)}},h.elements.resetBtn.onclick=(M)=>{h.app.reset()},h.elements.gtBtn.onclick=(M)=>{h.app.reset(),h.app.launchGTSolve()},h.elements.btBtn.onclick=(M)=>{h.app.reset(),h.app.launchBTSolve()}}function c(h){h.canvas.onmousemove=null,h.canvas.onmouseout=null,document.onkeyup=null}var s=function(h){const M=BigInt("999999999999");if(h<=M)return h.toString();else{const J=h.toString(),W=J.length,$=W-1;return`${J[0]+(W>1?"."+J.substring(1,3):"")}e${$}`}};class _{h;M;J;W;$;q;constructor(h,M,J,W,$,q){this._app=h;this._solutionSpaceSizeP=M;this._testedSolutionsP=J;this._prunedSolutionsP=W;this._progressP=$;this._timeleftP=q}display(){const h=this._app.solutionSpaceSize;if(typeof h==="undefined")return;this._solutionSpaceSizeP.innerText=`${s(h)}`;const{start:M,tested:J,pruned:W}=this._app.stats;this._testedSolutionsP.innerText=`${J}`,this._prunedSolutionsP.innerText=`${W}`}static create(h){return new _(h.app,h.solutionSpaceSizeP,h.testedSolutionsP,h.prunedSolutionsP,h.progressP,h.timeleftP)}}var G=getComputedStyle(document.documentElement);class L{h;M;static _ui=new WeakMap;_cellSize;static colorBackground=G.getPropertyValue("--neutral-white");static colorBackgroundHighlight=G.getPropertyValue("--brand-uno-background");static colorSelected=G.getPropertyValue("--brand-uno-hover");static colorText=G.getPropertyValue("--brand-uno");static colorTextLight=G.getPropertyValue("--brand-uno-light");static colorBorder=G.getPropertyValue("--sudoku-border");static colorBorderBold=G.getPropertyValue("--brand-uno");static colorSuccess=G.getPropertyValue("--signal-success");static colorSuccessBackground=G.getPropertyValue("--signal-success-background");static font=G.getPropertyValue("--font-family-primary");constructor(h,M){this._canvas=h;this._ctx=M;this._cellSize=Math.round(Math.min(h.width,h.height)/9)}static get(h){if(L._ui.has(h))return L._ui.get(h);const M=h.getContext("2d");if(M===null)return!1;const J=new L(h,M);return L._ui.set(h,J),J}get width(){return this._canvas.width}get height(){return this._canvas.height}get cellSize(){return this._cellSize}clearCanvas(){return this._ctx.fillStyle=L.colorBackground,this._ctx.fillRect(0,0,this.width,this.height),this}drawCell(h,M,J=this._cellSize,W=L.colorBorder,$){const q=h*J,Q=M*J;if($)this._ctx.fillStyle=$,this._ctx.fillRect(q+1,Q+1,J-2,J-2);return this._ctx.strokeStyle=W,this._ctx.strokeRect(q,Q,J,J),this}drawRow(h,M){for(let J=0;J<9;J++)this.drawCell(J,h,this._cellSize,L.colorBorder,M);return this}drawColumn(h,M){for(let J=0;J<9;J++)this.drawCell(h,J,this._cellSize,L.colorBorder,M);return this}drawGroup(h,M,J){this.drawCell(h,M,this._cellSize*3,L.colorBorderBold,J);for(let W=0;W<3;W++)for(let $=0;$<3;$++)this.drawCell(h*3+W,M*3+$,this._cellSize,L.colorBorder);return this}drawCellValue(h,M,J){this._ctx.fillStyle=L.colorText,this._ctx.font=`600 48px ${L.font}`,this._ctx.textBaseline="middle",this._ctx.textAlign="center";const W=h*this._cellSize+Math.floor(this._cellSize*0.5),$=M*this._cellSize+Math.floor(this._cellSize*0.575);return this._ctx.fillText(J.toString(),W,$),this}drawCellDomain(h,M,J){this._ctx.fillStyle=L.colorTextLight,this._ctx.font=`400 14px ${L.font}`,this._ctx.textBaseline="top",this._ctx.textAlign="start";const W=Math.max(this._cellSize-2,Math.floor(this._cellSize*0.8)),$=Math.floor(W/3),q=Math.max(1,Math.floor(this._cellSize*0.1)),Q=h*this._cellSize+q,Y=M*this._cellSize+q;for(let X=1;X<=9;X++){const g=J.has(X)?X:null,A=(X-1)%3,x=Math.floor((X-1)/3),E=Q+$*A,N=Y+$*x;this._ctx.fillText(g!==null?g.toString():"",E,N)}return this}drawEmptyGrid(){this.clearCanvas();for(let h=0;h<3;h++)for(let M=0;M<3;M++)this.drawGroup(h,M);return this}colorizeSelectedStuff(h){if(h===null)return this;const M=[Math.floor(h[0]/3),Math.floor(h[1]/3)];return this.drawRow(h[1],L.colorBackgroundHighlight).drawColumn(h[0],L.colorBackgroundHighlight).drawGroup(M[0],M[1],L.colorBackgroundHighlight).drawCell(h[0],h[1],this._cellSize,L.colorBorder,L.colorSelected),this}drawVictory(){return this._ctx.fillStyle=L.colorSuccessBackground,this._ctx.fillRect(0,0,this.width,this.height),this._ctx.fillStyle=L.colorSuccess,this._ctx.font=`600 72px ${L.font}`,this._ctx.textBaseline="middle",this._ctx.textAlign="center",this._ctx.fillText("Victory !".toUpperCase(),this._canvas.width/2,this._canvas.height/2),this}}function D(h,M){return z.fromJSON(h,M)}function j(h){return z.getByName(h)}class z{static domains=new Map;_values;constructor(h=[]){this._values=new Set(h)}add(h){this._values.add(h)}del(h){this._values.delete(h)}has(h){return this._values.has(h)}copy(h){const M=new z(this.toJSON());return z.domains.set(h,M),M}toJSON(){const h=[];for(let M of this._values)h.push(M);return h}getSize(){return this._values.size}static validateJSON(h){if(Array.isArray(h)&&h.length>0){const M=typeof h[0];if(!h.reduce((W,$)=>W&&typeof $===M,!0))return!1}return!0}static fromJSON(h,M){if(z.validateJSON(M)){const J=new z(M);return z.domains.set(h,J),J}throw new Error("At least one element do not have the same type as the other")}static getByName(h){return z.domains.get(h)}}function P(h,M){return V.fromJSON(h,M)}function F(h){return V.getByName(h)}class V{h;M;J;static variables=new Map;_value;constructor(h,M,J){this._name=h;this._domainName=M;this._domain=J}get name(){return this._name}get domain(){return this._domain}get value(){return this._value}set(h){if(this._domain.has(h))this._value=h}unset(){this._value=void 0}isSet(){return typeof this._value!=="undefined"}toJSON(){const h={domain:this._domainName};if(this.isSet())h.value=this._value;return h}static fromJSON(h,M){const J=j(M.domain);if(typeof J==="undefined")throw new Error(`The variable "${h}" reference an unknown domain "${M.domain}"`);const W=new V(h,M.domain,J.copy(`${h}-domain`));return V.variables.set(h,W),W}static getByName(h){return V.variables.get(h)}}class Z{h;static constraints=new Map;constructor(h){this._name=h}get name(){return this._name}static getByName(h){return Z.constraints.get(h)}}class H extends Z{M;J;static type="intension";static arity=1;constructor(h,M,J){super(h);this._v=M;this._checkConsistency=J}get type(){return H.type}get arity(){return H.arity}get variableName(){return this._v.name}checkConsistency(){return this._v.isSet()&&this._checkConsistency(this._v.value)}toJSON(){return{type:H.type,arity:H.arity,variable:this._v.name,valueConsistency:this._checkConsistency.toString()}}static create(h,M){const J=F(M.variable);if(!J)throw new Error(`The constraint "${h}" refer to an unknown variable "${M.variable}"`);const W=new H(h,J,M.valueConsistency);return Z.constraints.set(h,W),W}static fromJSON(h,M){const J=new Function(`return ${M.valueConsistency}`)(),W={...M,valueConsistency:J};return H.create(h,W)}}class R extends Z{M;static type="extension";static arity=1;_index;_areSupports;_areConflicts;constructor(h,M,J,W){super(h);this._v=M;this._index=new Set(J.filter(($)=>M.domain.has($))),this._areSupports=W==="supports",this._areConflicts=W==="conflicts"}get type(){return R.type}get arity(){return R.arity}get variableName(){return this._v.name}checkConsistency(){if(!this._v.isSet())return!1;return this._index.has(this._v.value)?this._areSupports:this._areConflicts}toJSON(){const h=[];for(let M of this._index.values())h.push(M);return{type:R.type,arity:R.arity,variable:this._v.name,values:h,valuesType:this._areSupports?"supports":"conflicts"}}static create(h,M){const J=F(M.variable);if(!J)throw new Error(`The constraint "${h}" refer to an unknown variable "${M.variable}"`);const W=new R(h,J,M.values,M.valuesType);return Z.constraints.set(h,W),W}static fromJSON(h,M){return R.create(h,M)}}function i(h){return h.type===H.type}function e(h){return h.type===H.type}function d(h,M){return i(M)?H.fromJSON(h,M):R.fromJSON(h,M)}function v(h,M){return e(M)?H.create(h,M):R.create(h,M)}var I=1;class w extends Z{M;J;static type="intension";static arity=2;constructor(h,M,J){super(h);this._v=M;this._checkConsistency=J}get type(){return w.type}get arity(){return w.arity}get variableNames(){return[this._v[0].name,this._v[1].name]}checkConsistency(){const[h,M]=this._v;return h.isSet()&&M.isSet()&&this._checkConsistency(h.value,M.value)}toJSON(){return{type:w.type,arity:w.arity,variables:this.variableNames,valuesConsistency:this._checkConsistency.toString()}}static create(h,M){const[J,W]=M.variables,$=F(J),q=F(W);if(!($&&q))throw new Error(`The constraint "${h}" refers to the variables "${J}" and "${W}" but one of them is unknown`);const Q=new w(h,[$,q],M.valuesConsistency);return Z.constraints.set(h,Q),Q}static fromJSON(h,M){const J=new Function(`return ${M.valuesConsistency}`)(),W={...M,valuesConsistency:J};return w.create(h,W)}}class O extends Z{M;static type="extension";static arity=2;_index;_areSupports;_areConflicts;constructor(h,M,J,W){super(h);this._v=M;const $=J.filter((q)=>M[0].domain.has(q[0])&&M[1].domain.has(q[1]));this._index=new Map;for(let q=0;q<$.length;q++){const[Q,Y]=$[q];if(!this._index.has(Q))this._index.set(Q,new Set);this._index.get(Q).add(Y)}this._areSupports=W==="supports",this._areConflicts=W==="conflicts"}get type(){return O.type}get arity(){return O.arity}get variableNames(){return[this._v[0].name,this._v[1].name]}checkConsistency(){const[h,M]=this._v;if(!(h.isSet()&&M.isSet()))return!1;const J=this._index.get(h.value);return J&&J.has(M.value)?this._areSupports:this._areConflicts}toJSON(){const h=[];for(let M of this._index.keys())for(let J of this._index.get(M).values())h.push([M,J]);return{type:O.type,arity:O.arity,variables:this.variableNames,tuples:h,tuplesType:this._areSupports?"supports":"conflicts"}}static create(h,M){const[J,W]=M.variables,$=F(J),q=F(W);if(!($&&q))throw new Error(`The constraint "${h}" refers to the variables "${J}" and "${W}" but one of them is unknown`);const Q=new O(h,[$,q],M.tuples,M.tuplesType);return Z.constraints.set(h,Q),Q}static fromJSON(h,M){return O.create(h,M)}}function a(h){return h.type===w.type}function n(h){return h.type===w.type}function p(h,M){return a(M)?w.fromJSON(h,M):O.fromJSON(h,M)}function u(h,M){return n(M)?w.create(h,M):O.create(h,M)}function hh(h){return h.arity===I}function Mh(h){return h.arity===I}function m(h,M){return hh(M)?d(h,M):p(h,M)}function y(h,M){return Mh(M)?v(h,M):u(h,M)}class T{h;M;J;W;_solutionSpaceSize;constructor(h,M,J,W){this._name=h;this._domains=M;this._variables=J;this._constraints=W;this._solutionSpaceSize=this.computeSolutionSpaceSize()}get name(){return this._name}get solutionsSpaceSize(){return this._solutionSpaceSize}get domains(){return this._domains}get variables(){return this._variables}get constraints(){return this._constraints}static bigintRatio(h,M){const J=this.simplifyFraction(h,M);return J[0]<=Number.MAX_SAFE_INTEGER&&J[1]<=Number.MAX_SAFE_INTEGER?Number(J[0])/Number(J[1]):J}computeSolutionSpaceSize(){let h=1n,M=0n;for(let J of this._variables.values())M=h*BigInt(J.domain.getSize()),h=M;return M}static pgcd(h,M){if(h===0n||M===0n)return 1n;const J=h>M?h:M,W=h<=M?h:M,$=J/W,q=J%W;return q===0n?$:this.pgcd($,q)}static simplifyFraction(h,M){let J=h,W=M,$=this.pgcd(J,W);while($>1n)J=J/$,W=W/$,$=this.pgcd(J,W);return[J,W]}toJSON(){const h={};for(let[W,$]of this._domains.entries())h[W]=$.toJSON();const M={};for(let[W,$]of this._variables.entries())M[W]=$.toJSON();const J={};for(let[W,$]of this._constraints.entries())J[W]=$.toJSON();return{name:this._name,domains:h,variables:M,constraints:J}}setAffectation(h){for(let M in h){const J=this._variables.get(M),W=h[M];if(J?.domain.has(W))J.set(W)}}unsetAffectation(h){for(let M in h){const J=this._variables.get(M);if(J?.isSet())J.unset()}}static propsToDomains(h){const M=new Map;for(let J in h.domains)M.set(J,D(J,h.domains[J]));return M}static propsToVariables(h){const M=new Map;for(let J in h.variables)M.set(J,P(J,h.variables[J]));return M}static propsToConstraints(h){const M=new Map;for(let J in h.constraints)M.set(J,m(J,h.constraints[J]));return M}static fromJSON(h){return new T(h.name,T.propsToDomains(h),T.propsToVariables(h),T.propsToConstraints(h))}}class f{h;_workingProblem;_solving=!1;constructor(h){this._initialProblem=h}get solving(){return this._solving}copyProblem(h){const M=h.toJSON();return T.fromJSON(M)}*_gtAffectation(){const h=[];for(let $ of this._workingProblem.variables.keys())h.push($);const M=[];for(let $ of h){const Q=this._workingProblem.variables.get($).domain.toJSON();if(Q.length===0)return;M.push([$,0,Q])}const J=M.reduce(($,[q,Q,Y])=>$+Y.length,0);let W=0;while(W<J&&this._solving){const $={};for(let[q,Q,Y]of M)$[q]=Y[Q];yield $,W=0;for(let q=M.length-1;q>=0;q--){const[Q,Y,X]=M[q];if(Y<X.length-1){M[q][1]++,W+=M[q][1];break}else M[q][1]=0}}}*gt(h=!0,M=!1){this._solving=!0,this._workingProblem=this.copyProblem(this._initialProblem);for(let J of this._gtAffectation()){if(!this._solving)return;const W=this._gtIsConsistent(J);if(W||M)yield[J,W];if(W&&h)return}}_gtIsConsistent(h){if(!this._workingProblem)return!1;this._workingProblem.setAffectation(h);for(let M of this._workingProblem.constraints.values())if(!M.checkConsistency())return!1;return this._workingProblem.unsetAffectation(h),!0}*_btAffectation(){const h=[];for(let $ of this._workingProblem.variables.keys())h.push($);const M=[];for(let $ of h){const Q=this._workingProblem.variables.get($).domain.toJSON();if(Q.length===0)return;M.push([$,0,Q])}const J=M.reduce(($,[q,Q,Y])=>$+Y.length,0);let W=0;while(W<J&&this._solving){const $={};for(let[q,Q,Y]of M)$[q]=Y[Q];yield $,W=0;for(let q=M.length-1;q>=0;q--){const[Q,Y,X]=M[q];if(Y<X.length-1){M[q][1]++,W+=M[q][1];break}else M[q][1]=0}}}*bt(h=!0,M=!1){this._solving=!0,this._workingProblem=this.copyProblem(this._initialProblem);for(let J of this._btAffectation()){if(!this._solving)return;const W=this._btIsConsistent(J);if(W||M)yield[J,W];if(W&&h)return}}_btIsConsistent(h){if(!this._workingProblem)return!1;this._workingProblem.setAffectation(h);for(let M of this._workingProblem.constraints.values())if(!M.checkConsistency())return!1;return this._workingProblem.unsetAffectation(h),!0}stop(){this._solving=!1}static create(h){return new f(h.problem)}}class K extends T{$;static baseCellDomain=D("baseCellDomain",[1,2,3,4,5,6,7,8,9]);static mustBeDifferent=(h,M)=>h!==M;constructor(h,M,J,W,$){super(h,M,J,W);this._ui=$}static prepareDomains(){const h=new Map,M=[];for(let J=0;J<9;J++){const W=[];for(let $=0;$<9;$++){const q=`d:${$}x${J}`,Q=K.baseCellDomain.copy(q);h.set(q,Q),W.push(q)}M.push(W)}return[h,M]}static vName(h,M){return`cell${h}x${M}`}static prepareVariables(h){const M=[],J=new Map;for(let W=0;W<9;W++){const $=[];for(let q=0;q<9;q++){const Q=h[W][q],Y=K.vName(q,W),X=P(Y,{domain:Q});J.set(Y,X),$.push(Y)}M.push($)}return[J,M]}static rule(h,M){return{type:"intension",arity:2,variables:[h,M],valuesConsistency:K.mustBeDifferent}}static prepareConstraints(h){const M=new Map;for(let J=0;J<9;J++)for(let W=0;W<9;W++)for(let $=W+1;$<9;$++){let q=`c:${W}x${J}->${$}x${J}`,Q=K.rule(h[J][W],h[J][$]),Y=y(q,Q);M.set(q,Y),q=`c:${J}x${W}->${J}x${$}`,Q=K.rule(h[W][J],h[$][J]),Y=y(q,Q),M.set(q,Y)}for(let J=0;J<9;J++){const W=J%3,$=(J-W)/3%3;for(let q=0;q<9;q++){const Q=q%3,Y=W+Q,X=(q-Q)/3%3,g=$+X;for(let A=q;A<9;A++){const x=A%3,E=W+x,N=(A-x)/3%3,U=$+N,b=`c:${Y}x${g}->${E}x${U}`,r=K.rule(h[g][Y],h[U][E]),t=y(b,r);M.set(b,t)}}}return M}static create(h){const[M,J]=K.prepareDomains(),[W,$]=K.prepareVariables(J),q=K.prepareConstraints($);return new K(h.name,M,W,q,h.ui)}_getVariable(h,M){const J=K.vName(h,M);return this._variables.get(J)}_drawCellContent(h,M){const J=this._getVariable(h,M);if(J)if(J.isSet())this._ui.drawCellValue(h,M,J.value);else this._ui.drawCellDomain(h,M,J.domain)}cellIsSet(h,M){return this._getVariable(h,M)?.isSet()??!1}domainHas(h,M,J){return this._getVariable(h,M)?.domain.has(J)??!1}drawCellsContent(){for(let h=0;h<9;h++)for(let M=0;M<9;M++)this._drawCellContent(M,h)}setCellValue(h,M,J){this._getVariable(h,M)?.set(J)}unsetCellValue(h,M){this._getVariable(h,M)?.unset()}getCellValue(h,M){return this._getVariable(h,M)?.value}_removeValue(h,M,J){this._getVariable(h,M)?.domain.del(J)}_addValue(h,M,J){this._getVariable(h,M)?.domain.add(J)}maintainImpactedCellsDomain(h,M,J,W){const $=W?this._removeValue.bind(this):this._addValue.bind(this);for(let Y=0;Y<9;Y++){if(Y!==h)$&&$(Y,M,J);if(Y!==M)$&&$(h,Y,J)}const q=Math.floor(h/3),Q=Math.floor(M/3);for(let Y=0;Y<3;Y++)for(let X=0;X<3;X++){const g=q*3+X,A=Q*3+Y;if(g!==h&&A!==M)$&&$(g,A,J)}}}class k{h;M;selectedCell=null;_problem;_statsDisplay;_solver;_iterationsMin=0;_iterationsMax=0;_lastTime=0;_startTime=0;_minDt=Number.MAX_SAFE_INTEGER;_handleRefreshStats=null;_solverSteps;_testedSolutions=0n;_prunedSolutions=0n;_gtIterator=null;_btIterator=null;constructor(h,M){this._ui=h;this._elements=M}get solutionSpaceSize(){return this._problem?.solutionsSpaceSize}get stats(){return{start:this._startTime,tested:this._testedSolutions,pruned:this._prunedSolutions}}_refreshGrid(){this._ui.drawEmptyGrid().colorizeSelectedStuff(this.selectedCell),this._problem?.drawCellsContent()}_toggle(h){if(!this._problem)return;const[M,J]=this.selectedCell;if(!this._problem.cellIsSet(M,J)){if(this._problem?.domainHas(M,J,h)??!1)this._problem?.setCellValue(M,J,h),this._problem?.maintainImpactedCellsDomain(M,J,h,!0),this._refreshGrid()}else if(this._problem?.getCellValue(M,J)===h){this._problem?.unsetCellValue(M,J),this._problem?.maintainImpactedCellsDomain(M,J,h,!1);for(let W=0;W<9;W++)for(let $=0;$<9;$++)if(this._problem?.getCellValue($,W)===h)this._problem?.maintainImpactedCellsDomain($,W,h,!0);this._refreshGrid()}}start(){if(S({app:this,elements:this._elements,ui:this._ui,refreshGrid:this._refreshGrid.bind(this),toggle:this._toggle.bind(this),getSelectedCell:()=>this.selectedCell,setSelectedCell:(h)=>this.selectedCell=h}),this._problem=K.create({name:`sudoku-${Date.now()}`,ui:this._ui}),this._refreshGrid(),!this._solver)this._solver=f.create({problem:this._problem});if(typeof this._statsDisplay==="undefined")this._statsDisplay=_.create({app:this,solutionSpaceSizeP:this._elements.solutionSpaceSizeP,testedSolutionsP:this._elements.testedSolutionsP,prunedSolutionsP:this._elements.prunedSolutionsP,progressP:this._elements.progressP,timeleftP:this._elements.timeleftP});this._statsDisplay.display()}stop(){if(this._solver?.stop(),this._gtIterator=null,this._btIterator=null,this._lastTime=0,this._solverSteps=void 0,c(this._elements),this._elements.ncCheckbox.checked=!1,this._elements.acNoneRadio.checked=!0,this._handleRefreshStats!==null)clearInterval(this._handleRefreshStats),this._handleRefreshStats=null}reset(){this.stop(),this.start()}_computeSolvingIterations(h){const M=h-this._lastTime;if(M*0.9<=this._minDt/2)this._iterationsMax*=2,this._iterationsMin*=2;else if(M*0.9<=this._minDt)this._iterationsMin=Math.floor(this._iterationsMin*1.5),this._iterationsMax=Math.max(this._iterationsMin+1,this._iterationsMax);else if(M*1.1>=this._minDt*2)this._iterationsMin=Math.max(Math.floor(this._iterationsMin/2),1),this._iterationsMax=Math.max(Math.floor(this._iterationsMax/2),2);else if(M*1.1>=this._minDt)this._iterationsMax=Math.ceil(this._iterationsMax*0.67),this._iterationsMin=Math.min(this._iterationsMax-1,this._iterationsMin);return this._minDt=Math.min(this._minDt,M),this._lastTime=h,Math.max(Math.floor((this._iterationsMax+this._iterationsMin)/2),1)}launchGTSolve(){if(!this._solver||this._solver.solving||!this._problem)return;if(this._startTime=Date.now(),this._testedSolutions=0n,this._prunedSolutions=0n,this._minDt=Number.MAX_SAFE_INTEGER,this._iterationsMin=1,this._iterationsMax=1000,this._handleRefreshStats===null)this._handleRefreshStats=setInterval(()=>{this._statsDisplay?.display()},500);if(this._solverSteps=(h)=>{let M=null;for(let J=0;J<h;J++){const[W,$]=this._gtIterator.next().value;if(M=W,this._testedSolutions++,$){this._gtIterator=null;break}}if(M)this._problem.setAffectation(M)},this._gtIterator===null)this._gtIterator=this._solver.gt(!0,!0);this._animateSolve(1000)}launchBTSolve(){if(!this._solver||this._solver.solving||!this._problem)return;if(this._startTime=Date.now(),this._testedSolutions=0n,this._prunedSolutions=0n,this._minDt=Number.MAX_SAFE_INTEGER,this._iterationsMin=1,this._iterationsMax=1000,this._handleRefreshStats===null)this._handleRefreshStats=setInterval(()=>{this._statsDisplay?.display()},500);if(this._solverSteps=(h)=>{let M=null;for(let J=0;J<h;J++){const[W,$]=this._btIterator.next().value;if(M=W,this._testedSolutions++,$){this._btIterator=null;break}}if(M)this._problem.setAffectation(M)},this._btIterator===null)this._btIterator=this._solver.bt(!0,!0);this._animateSolve(1000)}_animateSolve(h){if(this._solverSteps){if(this._solverSteps(this._computeSolvingIterations(h)),this._refreshGrid(),this._solver?.solving)requestAnimationFrame(this._animateSolve.bind(this))}}static create(h){const M=B(h);if(M===null)return null;const J=L.get(M.canvas);if(!J)return null;return new k(J,M)}}var Jh="sudokuCanvas",Wh="sudokuSolutionsSize",$h="reset",qh="GT",Qh="BT",Yh="NC",Lh="ACNone",Xh="AC1",Zh="AC3",Kh="testedSolutions",Hh="prunedSolutions",wh="progress",Gh="timeleft";C();var l=k.create({canvasId:Jh,solutionSpaceSizePId:Wh,resetBtnId:$h,gtBtnId:qh,btBtnId:Qh,ncCheckboxId:Yh,acNoneRadioId:Lh,ac1RadioId:Xh,ac3RadioId:Zh,testedSolutionsPId:Kh,prunedSolutionsPId:Hh,progressPId:wh,timeleftPId:Gh});l&&l.start();
